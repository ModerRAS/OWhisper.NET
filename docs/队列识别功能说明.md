# 🎯 队列识别功能说明

## 📋 功能概述

队列识别功能是 OWhisper.NET 的新增特性，允许用户批量处理多个音频文件，实现自动化的语音转录工作流。

### ✨ 主要特性

- **批量处理**: 支持一次性添加多个音频文件或整个文件夹
- **队列管理**: 自动排队处理，支持暂停、恢复和取消
- **实时监控**: 实时显示每个任务的处理状态和进度
- **自动保存**: 转录完成后自动保存到指定文件夹
- **智能分类**: 按日期自动创建子文件夹组织输出文件

## 🚀 使用方法

### 1. 启动队列管理器

从系统托盘右键菜单选择"队列识别"，即可打开队列管理窗口。

### 2. 添加音频文件

#### 方式一：添加单个或多个文件
1. 点击"添加文件"按钮
2. 在文件选择对话框中选择音频文件（支持多选）
3. 文件将自动添加到处理队列

#### 方式二：添加整个文件夹
1. 点击"添加文件夹"按钮
2. 选择包含音频文件的文件夹
3. 系统将自动扫描并添加所有支持的音频文件

### 3. 设置输出位置

1. 默认输出位置：`我的文档\OWhisper转录结果`
2. 点击"浏览"按钮可以更改输出文件夹
3. 转录结果将按日期自动分类存储

### 4. 开始处理

1. 点击"开始处理"按钮启动批量转录
2. 系统将按顺序处理队列中的每个文件
3. 可以随时点击"暂停处理"来停止处理

### 5. 监控进度

队列管理器提供详细的进度信息：
- **文件名**: 正在处理的音频文件名
- **状态**: 等待中、处理中、已完成、失败
- **进度**: 当前任务的处理百分比
- **队列位置**: 在等待队列中的位置
- **时间信息**: 添加时间和完成时间
- **输出文件**: 转录结果的保存路径

## 📁 文件组织结构

```
我的文档/OWhisper转录结果/
├── 2024-01-15/                 # 按日期分类
│   ├── 会议录音.txt
│   ├── 课程讲座.txt
│   └── 采访记录.txt
├── 2024-01-16/
│   ├── 电话会议.txt
│   └── 培训视频.txt
└── ...
```

## 🎵 支持的音频格式

- **WAV**: 无损音频格式（推荐）
- **MP3**: 常见的压缩音频格式
- **FLAC**: 无损压缩音频格式
- **OGG**: 开源音频格式
- **M4A**: Apple 音频格式
- **WMA**: Windows Media Audio
- **AAC**: 高级音频编码

## ⚙️ 托盘菜单变更

### 新菜单结构
```
┌─ 启动服务
├─ 停止服务
├─ ────────────
├─ 队列识别        ← 新增功能
├─ ────────────
├─ 检查更新        ← 保留
├─ 重启应用
├─ ────────────
├─ 调试窗口
├─ ────────────
└─ 退出
```

### 变更说明
- ✅ **新增**: "队列识别" - 打开批量处理管理器
- ✅ **保留**: "检查更新" - 检查软件更新
- ❌ **移除**: "下载更新" - 简化更新流程

## 🔧 功能详解

### 任务状态说明

| 状态 | 描述 | 颜色标识 |
|------|------|----------|
| 等待中 | 任务已加入队列，等待处理 | 白色 |
| 处理中 | 正在进行语音转录 | 浅蓝色 |
| 已完成 | 转录完成，文件已保存 | 浅绿色 |
| 失败 | 处理过程中出现错误 | 浅红色 |
| 已取消 | 用户主动取消的任务 | 灰色 |

### 队列管理操作

#### 添加任务
- 支持拖拽文件到窗口（计划功能）
- 自动去重，相同文件不会重复添加
- 实时预览输出路径

#### 控制操作
- **开始处理**: 启动队列服务，按顺序处理任务
- **暂停处理**: 停止队列服务，当前任务完成后暂停
- **移除选中**: 从队列中删除选定的任务
- **清空列表**: 清除所有未处理的任务

#### 状态监控
- 实时更新每个任务的处理进度
- 显示队列统计信息（总计、已完成、失败等）
- 自动刷新队列状态

## 📊 性能优化

### 处理策略
- **单线程处理**: 避免资源竞争，确保稳定性
- **内存管理**: 及时清理已完成任务的音频数据
- **断点续传**: 支持暂停后恢复处理
- **错误恢复**: 单个任务失败不影响其他任务

### 资源占用
- **CPU使用**: 转录期间CPU使用率较高
- **内存占用**: 根据音频文件大小动态调整
- **磁盘空间**: 转录结果通常比原始文件小得多
- **网络流量**: 本地处理，无网络传输

## 🛠️ 故障排除

### 常见问题

#### 1. 文件添加失败
**原因**: 文件格式不支持或文件损坏
**解决方案**: 检查音频文件格式，尝试使用音频转换工具

#### 2. 处理速度慢
**原因**: 音频文件过大或系统资源不足
**解决方案**: 
- 关闭其他占用CPU的程序
- 考虑将大文件分割成小段处理
- 确保有足够的系统内存

#### 3. 转录结果不准确
**原因**: 音频质量差或语言不匹配
**解决方案**:
- 使用高质量的录音设备
- 确保录音环境安静
- 选择正确的语言模型

#### 4. 保存失败
**原因**: 输出文件夹权限不足或磁盘空间不够
**解决方案**:
- 更改输出文件夹到有写入权限的位置
- 清理磁盘空间
- 以管理员权限运行程序

### 日志查看
程序运行日志保存在 `Logs` 文件夹中，可以查看详细的错误信息和处理过程。

## 🔮 未来计划

### 即将推出的功能
- **拖拽支持**: 直接拖拽文件到窗口添加任务
- **并行处理**: 支持多任务并行处理（可配置）
- **批量设置**: 统一设置语言、模型等参数
- **进度预估**: 显示剩余处理时间
- **结果预览**: 在窗口中直接预览转录结果
- **导出功能**: 支持导出为多种格式（Word、PDF等）

### 长期规划
- **云端同步**: 支持转录结果云端存储
- **团队协作**: 多用户共享队列和结果
- **API集成**: 提供RESTful API接口
- **插件系统**: 支持第三方插件扩展

## 📞 技术支持

如果在使用过程中遇到问题，可以：

1. **查看日志**: 检查 `Logs` 文件夹中的详细错误信息
2. **调试模式**: 使用 `--debug` 参数启动程序查看详细信息
3. **GitHub Issues**: 在项目仓库提交问题报告
4. **社区讨论**: 参与社区讨论获取帮助

---

**注意**: 队列识别功能基于现有的转录服务，继承了所有核心功能的稳定性和准确性。建议在大批量处理前先用小文件测试效果。 